//go:build desktop

package main

import (
	"flag"
	"fmt"
	"net/http"

	"{{MODULE_PATH}}/app"
	"github.com/stukennedy/irgo/desktop"
)

func main() {
	devMode := flag.Bool("dev", false, "Enable devtools")
	flag.Parse()

	r := app.NewRouter()

	// Create HTTP mux with static file serving
	mux := http.NewServeMux()
	staticDir := desktop.FindStaticDir()
	mux.Handle("/static/", http.StripPrefix("/static/", http.FileServer(http.Dir(staticDir))))
	mux.Handle("/", r.Handler())

	// Configure desktop app
	config := desktop.DefaultConfig()
	config.Title = "{{PROJECT_NAME}}"
	config.Debug = *devMode

	// Create and run desktop app
	desktopApp := desktop.New(mux, config)

	fmt.Println("Starting {{PROJECT_NAME}} desktop app...")
	if err := desktopApp.Run(); err != nil {
		fmt.Printf("Error: %v\n", err)
	}
}
